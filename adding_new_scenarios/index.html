
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://medhelm.org/adding_new_scenarios/">
      
      
        <link rel="prev" href="../adding_new_models/">
      
      
        <link rel="next" href="../adding_new_tokenizers/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Adding New Scenarios - MedHELM</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../docstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adding-new-scenarios" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MedHELM" class="md-header__button md-logo" aria-label="MedHELM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MedHELM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Adding New Scenarios
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Pacific-AI-Corp/medhelm/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MedHELM" class="md-nav__button md-logo" aria-label="MedHELM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MedHELM
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Pacific-AI-Corp/medhelm/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Holistic Evaluation of Language Models (HELM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../run_entries_configuration_files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run Entries Configuration Files
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../run_entries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run Entries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../credentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../importing_custom_modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importing Custom Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adding_new_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding New Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Adding New Scenarios
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding New Scenarios
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-scenario-subclass" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Scenario subclass
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom Scenario subclass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downloading-data-to-local-disk" class="md-nav__link">
    <span class="md-ellipsis">
      
        Downloading data to local disk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-hugging-face-datasets" class="md-nav__link">
    <span class="md-ellipsis">
      
        Working with Hugging Face datasets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-run-spec-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom run spec function
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom run spec function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging-with-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Debugging with models
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing-your-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contributing your scenario
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adding_new_tokenizers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding New Tokenizers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../downloading_raw_results/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Downloading Raw Results
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reproducing_leaderboards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reproducing Leaderboards
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../get_helm_rank/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Efficient-HELM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Benchmarking Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../huggingface_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hugging Face Model Hub Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Papers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Papers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HEIM (Text-to-image Model Evaluation)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vhelm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VHELM (Vision-Language Models)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise_benchmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Enterprise benchmark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reeval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reliable and Efficient Amortized Model-based Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../medhelm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MedHELM: Holistic Evaluation of Large Language Models for Medical Applications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perturbations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Perturbations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scenarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scenarios
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Developer Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Developer Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Developer Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer_adding_new_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding New Clients
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proxy_server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Proxy Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../editing_documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Editing Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-scenario-subclass" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Scenario subclass
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom Scenario subclass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downloading-data-to-local-disk" class="md-nav__link">
    <span class="md-ellipsis">
      
        Downloading data to local disk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-hugging-face-datasets" class="md-nav__link">
    <span class="md-ellipsis">
      
        Working with Hugging Face datasets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-run-spec-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom run spec function
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom run spec function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging-with-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Debugging with models
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing-your-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contributing your scenario
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="adding-new-scenarios">Adding New Scenarios</h1>
<p>HELM comes with more than a hundred built-in scenarios. However, you may want to run HELM on a scenario that is not built into HELM yet, or you may want to run HELM on scenarios that use your private datasets. Because HELM is a modular framework with a plug-in architecture, you can run evaluations with your custom scenarios on HELM without needing to modify HELM code.</p>
<p>There are two steps to adding a custom scenario: adding the custom <code>Scenario</code> subclass, and adding a custom run spec function.</p>
<p>The easiest way to implement the custom <code>Scenario</code> subclass and the custom run spec function would be to copy from an appropriate example and then make the appropriate modifications. Determine the <strong>task</strong> of your scenario, then find the corresponding example <code>Scenario</code> subclass and run spec function from the list below from the <code>simple_scenarios.py</code> and <code>simple_run_specs.py</code> files:</p>
<ul>
<li><strong>Multiple-choice question answering</strong>: <code>SimpleMCQAScenario</code> and <code>get_simple_mcqa_run_spec()</code></li>
<li><strong>Short-answer question answering</strong>: <code>SimpleShortAnswerQAScenario</code> and <code>get_simple_short_answer_qa_run_spec()</code></li>
<li><strong>Open-ended question answering</strong>: This is similar to short-answer question answering, but overlap-based automated metrics may be unsuitable for long generations.</li>
<li><strong>Summarization</strong>: This is similar to short-answer question answering, but overlap-based automated metrics may be unsuitable for long generations.</li>
<li><strong>Multi-class classification</strong>: <code>SimpleClassificationScenario</code> and <code>get_simple_classification_run_spec()</code></li>
<li><strong>Sentiment analysis</strong>: This a sub-type of the Classification task. Set <code>input_noun</code>, <code>output_noun</code> and <code>instructions</code> appropriately.</li>
<li><strong>Toxicity detection</strong>: This a sub-type of the Classification task. Set <code>input_noun</code>, <code>output_noun</code> and <code>instructions</code> appropriately.</li>
<li><strong>Multi-label classification</strong>: This is currently unsupported by HELM.</li>
<li><strong>Named entity recognition</strong>: This is currently unsupported by HELM.</li>
</ul>
<p>If your task is not listed, you may still implement your task using custom adapters and metrics, but there is limited official support for doing so.</p>
<h2 id="custom-scenario-subclass">Custom <code>Scenario</code> subclass</h2>
<p>For this tutorial, we will create a <code>MyScenario</code> class in the the <code>my_scenario</code> module. Make a file called <code>./my_scenario.py</code> under the my_scenario directory. Create a new class called <code>MyScenario</code>. Find the appropriate example scenario and copy its implementation into <code>MyScenario</code>, making sure to also copy all the required imports.</p>
<p>Now we will create a test for the scenario to make sure that it is working correctly. Create a file called <code>./my_scenario_test.py</code> under the my_scenario directory. Create a <code>test_my_scenario()</code> function in this file. Find the appropriate example scenario test from <code>test_simple_scenarios.py</code> and copy its implementation into <code>test_my_scenario()</code>.</p>
<p>You can now run <code>python3 -m pytest test_my_scenario.py</code> to test the example scenario. The test should pass. If you get a <code>ModuleNotFound</code> error, you should set up your <code>PYTHONPATH</code> as explained above, and then try again.</p>
<p>Now, modify <code>MyScenario</code> to include the actual logic to load the instances from your dataset. Modify the test accordingly. Use the test to ensure that your implementation is working.</p>
<h3 id="downloading-data-to-local-disk">Downloading data to local disk</h3>
<p>Frequently, your <code>Scenario</code> will want to download and cache data onto the local disk, rather than downloading it from the internet every time. The <code>output_path</code> argument passed into the <code>get_instances()</code> method will contain a file path to a scenario-specific download folder that you should download these files to. The folder will be under the <code>scenarios</code> subdirectory under the <code>benchmark_output/</code> folder (or the path specified by the <code>--output-path</code> flag for <code>helm-run</code>). You can use the <code>ensure_directory_exists()</code> and <code>ensure_file_downloaded()</code> helper functions to download files, which has the advantage of skipping the download if the file already exists. You can also use set <code>unpack=True</code> in <code>ensure_file_downloaded()</code> to automatically unpack most archive files (e.g. <code>.tar.gz</code> and <code>.zip</code> files).</p>
<p>For examples, refer to:</p>
<ul>
<li><code>gsm_scenario.py</code> - download a JSONL files</li>
<li><code>mmlu_scenario.py</code> - download CSV files</li>
<li><code>narrativeqa_scenario.py</code> - download a zip file containing CSV files</li>
</ul>
<h3 id="working-with-hugging-face-datasets">Working with Hugging Face datasets</h3>
<p>Another frequent use case is downloading data from Hugging Face datasets. You can use <code>load_dataset()</code> to do so. It is recommended that you set the <code>cache_dir</code> parameter to a subdirectory within <code>output_path</code>. This ensures hermeticity by ensuring that the data is downloaded into the scenario-specific download folder.</p>
<p>For an example, refer to:</p>
<ul>
<li><code>math_scenario.py</code></li>
<li><code>legalbench_scenario.py</code></li>
</ul>
<h2 id="custom-run-spec-function">Custom run spec function</h2>
<p>A run spec function is the entry point to the scenario. A run spec function produces a <code>RunSpec</code> (a configuration for an evaluation run). <code>helm-run</code> will run the run spec function to get the <code>RunSpec</code>, and then it will run the evaluation defined by that <code>RunSpec</code>.</p>
<p>HELM will search for modules with names matching these patterns for run spec functions:</p>
<ul>
<li><code>helm.benchmark.run_specs.*_run_specs</code></li>
<li><code>helm_*_run_specs</code> (i.e. a root module)</li>
</ul>
<p>For this tutorial, we will create a <code>get_my_run_spec()</code> function in the <code>helm_my_run_specs</code> module. Under the <code>src/helm/benchmark/scenarios/</code> directory, create a file called <code>helm_my_run_specs.py</code>. Then, create a <code>get_my_run_spec()</code> function in this file and find the appropriate example run spec function from <code>simple_run_specs.py</code> to copy its implementation into <code>get_my_run_spec()</code>. Change the file accordingly to the needs of your scenario.</p>
<p>Now run:</p>
<pre><code>helm-run --run-entries custom:model=openai/gpt2 --suite custom --max-eval-instances 5
</code></pre>
<p>If you get a <code>ValueError: Unknown run spec name</code> error, you should set up your <code>PYTHONPATH</code> as explained above, and then try again.</p>
<h3 id="debugging-with-models">Debugging with models</h3>
<p>The above run entry uses the <code>openai/gpt2</code> model, which is a lightweight model that is reasonably fast, even when using only CPU inference without a GPU.</p>
<p>However, you might want to avoid waiting for model inference when implementing a scenario in order to speed up your iteration times. To do so, you can use the <code>simple/model1</code>, which simply echoes the last word in the prompt. Example <code>helm-run</code> command:</p>
<pre><code>helm-run --run-entries custom:model=simple/model1 --suite custom --max-eval-instances 5
</code></pre>
<p>Note: Both the custom <code>Scenario</code> subclass and the custom run spec function will be added to custom Python modules that have to be importable by Python. The easiest way to do this is to place your custom Python modules under the current working directory and then run <code>export PYTHONPATH=".:$PYTHONPATH"</code> in your shell. Refer to the Importing Custom Modules documentation for other ways to do this.</p>
<h2 id="contributing-your-scenario">Contributing your scenario</h2>
<p>We welcome scenario contributions to HELM if they fit the following criteria:</p>
<ul>
<li>It is commonly-used or notable benchmark (e.g. it has a published paper).</li>
<li>It uses publicly available datasets.</li>
<li>It fills a gap in coverage by HELM's existing scenarios.</li>
</ul>
<p>If your scenario fits this criteria, you should move the files to the conventional HELM locations, and open a pull request. Your <code>*_scenario.py</code> file should be placed in <code>src/helm/benchmark/scenarios/</code> and  your <code>*_run_specs.py</code> file should be placed in <code>src/helm/benchmark/scenarios/</code>. More documentation on the contributor workflow will be added later.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>